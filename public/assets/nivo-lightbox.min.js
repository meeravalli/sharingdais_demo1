/*
 * Nivo Lightbox v1.0
 * http://dev7studios.com/nivo-lightbox
 *
 * Copyright 2013, Dev7studios
 * Free to use and abuse under the MIT license.
 * http://www.opensource.org/licenses/mit-license.php
 */
!function(t,e){function i(e,i){this.el=e,this.$el=t(this.el),this.options=t.extend({},o,i),this._defaults=o,this._name=n,this.init()}var n="nivoLightbox",o={effect:"fade",theme:"default",keyboardNav:!0,onInit:function(){},beforeShowLightbox:function(){},afterShowLightbox:function(){},beforeHideLightbox:function(){},afterHideLightbox:function(){},onPrev:function(){},onNext:function(){},errorMessage:"The requested content cannot be loaded. Please try again later."};i.prototype={init:function(){var e=this;this.$el.on("click",function(t){t.preventDefault(),e.showLightbox()}),this.options.keyboardNav&&t("body").off("keyup").on("keyup",function(i){var n=i.keyCode?i.keyCode:i.which;27==n&&e.destructLightbox(),37==n&&t(".nivo-lightbox-prev").trigger("click"),39==n&&t(".nivo-lightbox-next").trigger("click")}),this.options.onInit.call(this)},showLightbox:function(){var e=this;this.options.beforeShowLightbox.call(this);var i=this.constructLightbox();if(i){var n=i.find(".nivo-lightbox-content");if(n){var o=this.$el;if(t("body").addClass("nivo-lightbox-body-effect-"+this.options.effect),this.processContent(n,o),this.$el.attr("data-lightbox-gallery")){var e=this,s=t('[data-lightbox-gallery="'+this.$el.attr("data-lightbox-gallery")+'"]');t(".nivo-lightbox-nav").show(),t(".nivo-lightbox-prev").off("click").on("click",function(i){i.preventDefault();var r=s.index(o);o=s.eq(r-1),t(o).length||(o=s.last()),e.processContent(n,o),e.options.onPrev.call(this,[o])}),t(".nivo-lightbox-next").off("click").on("click",function(i){i.preventDefault();var r=s.index(o);o=s.eq(r+1),t(o).length||(o=s.first()),e.processContent(n,o),e.options.onNext.call(this,[o])})}setTimeout(function(){i.addClass("nivo-lightbox-open"),e.options.afterShowLightbox.call(this,[i])},1)}}},processContent:function(i,n){var o=this,s=n.attr("href");if(i.html("").addClass("nivo-lightbox-loading"),this.isHidpi()&&n.attr("data-lightbox-hidpi")&&(s=n.attr("data-lightbox-hidpi")),null!=s.match(/\.(jpeg|jpg|gif|png)$/)){var r=t("<img>",{src:s});r.one("load",function(){var n=t('<div class="nivo-lightbox-image" />');n.append(r),i.html(n).removeClass("nivo-lightbox-loading"),n.css({"line-height":t(".nivo-lightbox-content").height()+"px",height:t(".nivo-lightbox-content").height()+"px"}),t(e).resize(function(){n.css({"line-height":t(".nivo-lightbox-content").height()+"px",height:t(".nivo-lightbox-content").height()+"px"})})}).each(function(){this.complete&&t(this).load()}),r.error(function(){var e=t('<div class="nivo-lightbox-error"><p>'+o.options.errorMessage+"</p></div>");i.html(e).removeClass("nivo-lightbox-loading")})}else if(video=s.match(/(youtube|youtu|vimeo)\.(com|be)\/(watch\?v=(\w+)|(\w+))/)){var a="",l="nivo-lightbox-video";if("youtube"==video[1]&&(a="http://www.youtube.com/v/"+video[4],l="nivo-lightbox-youtube"),"youtu"==video[1]&&(a="http://www.youtube.com/v/"+video[3],l="nivo-lightbox-youtube"),"vimeo"==video[1]&&(a="http://player.vimeo.com/video/"+video[3],l="nivo-lightbox-vimeo"),a){var h=t("<iframe>",{src:a,"class":l,frameborder:0,vspace:0,hspace:0,scrolling:"auto"});i.html(h),h.load(function(){i.removeClass("nivo-lightbox-loading")})}}else if("ajax"==n.attr("data-lightbox-type")){var o=this;t.ajax({url:s,cache:!1,success:function(n){var o=t('<div class="nivo-lightbox-ajax" />');o.append(n),i.html(o).removeClass("nivo-lightbox-loading"),o.outerHeight()<i.height()&&o.css({position:"relative",top:"50%","margin-top":-(o.outerHeight()/2)+"px"}),t(e).resize(function(){o.outerHeight()<i.height()&&o.css({position:"relative",top:"50%","margin-top":-(o.outerHeight()/2)+"px"})})},error:function(){var e=t('<div class="nivo-lightbox-error"><p>'+o.options.errorMessage+"</p></div>");i.html(e).removeClass("nivo-lightbox-loading")}})}else if("#"==s.substring(0,1))if(t(s).length){var c=t('<div class="nivo-lightbox-inline" />');c.append(t(s).clone().show()),i.html(c).removeClass("nivo-lightbox-loading"),c.outerHeight()<i.height()&&c.css({position:"relative",top:"50%","margin-top":-(c.outerHeight()/2)+"px"}),t(e).resize(function(){c.outerHeight()<i.height()&&c.css({position:"relative",top:"50%","margin-top":-(c.outerHeight()/2)+"px"})})}else{var c=t('<div class="nivo-lightbox-error"><p>'+o.options.errorMessage+"</p></div>");i.html(c).removeClass("nivo-lightbox-loading")}else{var h=t("<iframe>",{src:s,"class":"nivo-lightbox-item",frameborder:0,vspace:0,hspace:0,scrolling:"auto"});i.html(h),h.load(function(){i.removeClass("nivo-lightbox-loading")})}if(n.attr("title")){var u=t("<span>",{"class":"nivo-lightbox-title"});u.text(n.attr("title")),t(".nivo-lightbox-title-wrap").html(u)}else t(".nivo-lightbox-title-wrap").html("")},constructLightbox:function(){if(t(".nivo-lightbox-overlay").length)return t(".nivo-lightbox-overlay");var e=t("<div>",{"class":"nivo-lightbox-overlay nivo-lightbox-theme-"+this.options.theme+" nivo-lightbox-effect-"+this.options.effect}),i=t("<div>",{"class":"nivo-lightbox-wrap"}),n=t("<div>",{"class":"nivo-lightbox-content"}),o=t('<a href="#" class="nivo-lightbox-nav nivo-lightbox-prev">Previous</a><a href="#" class="nivo-lightbox-nav nivo-lightbox-next">Next</a>'),s=t('<a href="#" class="nivo-lightbox-close" title="Close">Close</a>'),r=t("<div>",{"class":"nivo-lightbox-title-wrap"}),a=0;a&&e.addClass("nivo-lightbox-ie"),i.append(n),i.append(r),e.append(i),e.append(o),e.append(s),t("body").append(e);var l=this;return e.on("click",function(e){(e.target===this||t(e.target).hasClass("nivo-lightbox-content")||t(e.target).hasClass("nivo-lightbox-image"))&&l.destructLightbox()}),s.on("click",function(t){t.preventDefault(),l.destructLightbox()}),e},destructLightbox:function(){var e=this;this.options.beforeHideLightbox.call(this),t(".nivo-lightbox-overlay").removeClass("nivo-lightbox-open"),t(".nivo-lightbox-nav").hide(),t("body").removeClass("nivo-lightbox-body-effect-"+e.options.effect);var i=0;i&&(t(".nivo-lightbox-overlay iframe").attr("src"," "),t(".nivo-lightbox-overlay iframe").remove()),t(".nivo-lightbox-prev").off("click"),t(".nivo-lightbox-next").off("click"),this.options.afterHideLightbox.call(this)},isHidpi:function(){var t="(-webkit-min-device-pixel-ratio: 1.5),							  (min--moz-device-pixel-ratio: 1.5),							  (-o-min-device-pixel-ratio: 3/2),							  (min-resolution: 1.5dppx)";return e.devicePixelRatio>1?!0:e.matchMedia&&e.matchMedia(t).matches?!0:!1}},t.fn[n]=function(e){return this.each(function(){t.data(this,n)||t.data(this,n,new i(this,e))})}}(jQuery,window,document);